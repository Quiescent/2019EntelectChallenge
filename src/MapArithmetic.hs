{-# LANGUAGE BangPatterns #-}
{-# LANGUAGE NoImplicitPrelude #-}
{-# LANGUAGE ScopedTypeVariables #-}
{-# LANGUAGE DeriveGeneric #-}
{-# LANGUAGE OverloadedStrings #-}
{-# LANGUAGE FlexibleInstances #-}

module MapArithmetic
  where

import Import

import qualified RIO.Vector.Boxed as V
import qualified RIO.Vector.Boxed.Unsafe as UV

type Coord = Int

mapDim :: Int
mapDim = 33

toCoord :: Int -> Int -> Coord
toCoord xCoord yCoord =
  mapDim * yCoord + xCoord

allManhattanDistances :: V.Vector Int
allManhattanDistances =
  V.fromList $ do
    this <- [0..mapLength - 1]
    that <- [0..mapLength - 1]
    return $ manhattanDistance' this that
  where
    manhattanDistance' :: Coord -> Coord -> Int
    manhattanDistance' xy' xy'' =
      let (x',  y')  = fromCoord xy'
          (x'', y'') = fromCoord xy''
      in (abs $ x'' - x') + (abs $ y'' - y')

mapLength :: Int
mapLength = mapDim * mapDim

manhattanDistance :: Coord -> Coord -> Int
manhattanDistance xy' xy'' =
  allManhattanDistances `UV.unsafeIndex` (xy' * mapLength + xy'')

-- Generated with:
-- putStrLn $ concat $ map (\ x -> "fromCoord " ++ show x ++ " = " ++ (show $ fromCoord x) ++ "\n") [0..(mapDim*mapDim)]
fromCoord :: Coord -> (Int, Int)
fromCoord 0    = (0,0)
fromCoord 1    = (1,0)
fromCoord 2    = (2,0)
fromCoord 3    = (3,0)
fromCoord 4    = (4,0)
fromCoord 5    = (5,0)
fromCoord 6    = (6,0)
fromCoord 7    = (7,0)
fromCoord 8    = (8,0)
fromCoord 9    = (9,0)
fromCoord 10   = (10,0)
fromCoord 11   = (11,0)
fromCoord 12   = (12,0)
fromCoord 13   = (13,0)
fromCoord 14   = (14,0)
fromCoord 15   = (15,0)
fromCoord 16   = (16,0)
fromCoord 17   = (17,0)
fromCoord 18   = (18,0)
fromCoord 19   = (19,0)
fromCoord 20   = (20,0)
fromCoord 21   = (21,0)
fromCoord 22   = (22,0)
fromCoord 23   = (23,0)
fromCoord 24   = (24,0)
fromCoord 25   = (25,0)
fromCoord 26   = (26,0)
fromCoord 27   = (27,0)
fromCoord 28   = (28,0)
fromCoord 29   = (29,0)
fromCoord 30   = (30,0)
fromCoord 31   = (31,0)
fromCoord 32   = (32,0)
fromCoord 33   = (0,1)
fromCoord 34   = (1,1)
fromCoord 35   = (2,1)
fromCoord 36   = (3,1)
fromCoord 37   = (4,1)
fromCoord 38   = (5,1)
fromCoord 39   = (6,1)
fromCoord 40   = (7,1)
fromCoord 41   = (8,1)
fromCoord 42   = (9,1)
fromCoord 43   = (10,1)
fromCoord 44   = (11,1)
fromCoord 45   = (12,1)
fromCoord 46   = (13,1)
fromCoord 47   = (14,1)
fromCoord 48   = (15,1)
fromCoord 49   = (16,1)
fromCoord 50   = (17,1)
fromCoord 51   = (18,1)
fromCoord 52   = (19,1)
fromCoord 53   = (20,1)
fromCoord 54   = (21,1)
fromCoord 55   = (22,1)
fromCoord 56   = (23,1)
fromCoord 57   = (24,1)
fromCoord 58   = (25,1)
fromCoord 59   = (26,1)
fromCoord 60   = (27,1)
fromCoord 61   = (28,1)
fromCoord 62   = (29,1)
fromCoord 63   = (30,1)
fromCoord 64   = (31,1)
fromCoord 65   = (32,1)
fromCoord 66   = (0,2)
fromCoord 67   = (1,2)
fromCoord 68   = (2,2)
fromCoord 69   = (3,2)
fromCoord 70   = (4,2)
fromCoord 71   = (5,2)
fromCoord 72   = (6,2)
fromCoord 73   = (7,2)
fromCoord 74   = (8,2)
fromCoord 75   = (9,2)
fromCoord 76   = (10,2)
fromCoord 77   = (11,2)
fromCoord 78   = (12,2)
fromCoord 79   = (13,2)
fromCoord 80   = (14,2)
fromCoord 81   = (15,2)
fromCoord 82   = (16,2)
fromCoord 83   = (17,2)
fromCoord 84   = (18,2)
fromCoord 85   = (19,2)
fromCoord 86   = (20,2)
fromCoord 87   = (21,2)
fromCoord 88   = (22,2)
fromCoord 89   = (23,2)
fromCoord 90   = (24,2)
fromCoord 91   = (25,2)
fromCoord 92   = (26,2)
fromCoord 93   = (27,2)
fromCoord 94   = (28,2)
fromCoord 95   = (29,2)
fromCoord 96   = (30,2)
fromCoord 97   = (31,2)
fromCoord 98   = (32,2)
fromCoord 99   = (0,3)
fromCoord 100  = (1,3)
fromCoord 101  = (2,3)
fromCoord 102  = (3,3)
fromCoord 103  = (4,3)
fromCoord 104  = (5,3)
fromCoord 105  = (6,3)
fromCoord 106  = (7,3)
fromCoord 107  = (8,3)
fromCoord 108  = (9,3)
fromCoord 109  = (10,3)
fromCoord 110  = (11,3)
fromCoord 111  = (12,3)
fromCoord 112  = (13,3)
fromCoord 113  = (14,3)
fromCoord 114  = (15,3)
fromCoord 115  = (16,3)
fromCoord 116  = (17,3)
fromCoord 117  = (18,3)
fromCoord 118  = (19,3)
fromCoord 119  = (20,3)
fromCoord 120  = (21,3)
fromCoord 121  = (22,3)
fromCoord 122  = (23,3)
fromCoord 123  = (24,3)
fromCoord 124  = (25,3)
fromCoord 125  = (26,3)
fromCoord 126  = (27,3)
fromCoord 127  = (28,3)
fromCoord 128  = (29,3)
fromCoord 129  = (30,3)
fromCoord 130  = (31,3)
fromCoord 131  = (32,3)
fromCoord 132  = (0,4)
fromCoord 133  = (1,4)
fromCoord 134  = (2,4)
fromCoord 135  = (3,4)
fromCoord 136  = (4,4)
fromCoord 137  = (5,4)
fromCoord 138  = (6,4)
fromCoord 139  = (7,4)
fromCoord 140  = (8,4)
fromCoord 141  = (9,4)
fromCoord 142  = (10,4)
fromCoord 143  = (11,4)
fromCoord 144  = (12,4)
fromCoord 145  = (13,4)
fromCoord 146  = (14,4)
fromCoord 147  = (15,4)
fromCoord 148  = (16,4)
fromCoord 149  = (17,4)
fromCoord 150  = (18,4)
fromCoord 151  = (19,4)
fromCoord 152  = (20,4)
fromCoord 153  = (21,4)
fromCoord 154  = (22,4)
fromCoord 155  = (23,4)
fromCoord 156  = (24,4)
fromCoord 157  = (25,4)
fromCoord 158  = (26,4)
fromCoord 159  = (27,4)
fromCoord 160  = (28,4)
fromCoord 161  = (29,4)
fromCoord 162  = (30,4)
fromCoord 163  = (31,4)
fromCoord 164  = (32,4)
fromCoord 165  = (0,5)
fromCoord 166  = (1,5)
fromCoord 167  = (2,5)
fromCoord 168  = (3,5)
fromCoord 169  = (4,5)
fromCoord 170  = (5,5)
fromCoord 171  = (6,5)
fromCoord 172  = (7,5)
fromCoord 173  = (8,5)
fromCoord 174  = (9,5)
fromCoord 175  = (10,5)
fromCoord 176  = (11,5)
fromCoord 177  = (12,5)
fromCoord 178  = (13,5)
fromCoord 179  = (14,5)
fromCoord 180  = (15,5)
fromCoord 181  = (16,5)
fromCoord 182  = (17,5)
fromCoord 183  = (18,5)
fromCoord 184  = (19,5)
fromCoord 185  = (20,5)
fromCoord 186  = (21,5)
fromCoord 187  = (22,5)
fromCoord 188  = (23,5)
fromCoord 189  = (24,5)
fromCoord 190  = (25,5)
fromCoord 191  = (26,5)
fromCoord 192  = (27,5)
fromCoord 193  = (28,5)
fromCoord 194  = (29,5)
fromCoord 195  = (30,5)
fromCoord 196  = (31,5)
fromCoord 197  = (32,5)
fromCoord 198  = (0,6)
fromCoord 199  = (1,6)
fromCoord 200  = (2,6)
fromCoord 201  = (3,6)
fromCoord 202  = (4,6)
fromCoord 203  = (5,6)
fromCoord 204  = (6,6)
fromCoord 205  = (7,6)
fromCoord 206  = (8,6)
fromCoord 207  = (9,6)
fromCoord 208  = (10,6)
fromCoord 209  = (11,6)
fromCoord 210  = (12,6)
fromCoord 211  = (13,6)
fromCoord 212  = (14,6)
fromCoord 213  = (15,6)
fromCoord 214  = (16,6)
fromCoord 215  = (17,6)
fromCoord 216  = (18,6)
fromCoord 217  = (19,6)
fromCoord 218  = (20,6)
fromCoord 219  = (21,6)
fromCoord 220  = (22,6)
fromCoord 221  = (23,6)
fromCoord 222  = (24,6)
fromCoord 223  = (25,6)
fromCoord 224  = (26,6)
fromCoord 225  = (27,6)
fromCoord 226  = (28,6)
fromCoord 227  = (29,6)
fromCoord 228  = (30,6)
fromCoord 229  = (31,6)
fromCoord 230  = (32,6)
fromCoord 231  = (0,7)
fromCoord 232  = (1,7)
fromCoord 233  = (2,7)
fromCoord 234  = (3,7)
fromCoord 235  = (4,7)
fromCoord 236  = (5,7)
fromCoord 237  = (6,7)
fromCoord 238  = (7,7)
fromCoord 239  = (8,7)
fromCoord 240  = (9,7)
fromCoord 241  = (10,7)
fromCoord 242  = (11,7)
fromCoord 243  = (12,7)
fromCoord 244  = (13,7)
fromCoord 245  = (14,7)
fromCoord 246  = (15,7)
fromCoord 247  = (16,7)
fromCoord 248  = (17,7)
fromCoord 249  = (18,7)
fromCoord 250  = (19,7)
fromCoord 251  = (20,7)
fromCoord 252  = (21,7)
fromCoord 253  = (22,7)
fromCoord 254  = (23,7)
fromCoord 255  = (24,7)
fromCoord 256  = (25,7)
fromCoord 257  = (26,7)
fromCoord 258  = (27,7)
fromCoord 259  = (28,7)
fromCoord 260  = (29,7)
fromCoord 261  = (30,7)
fromCoord 262  = (31,7)
fromCoord 263  = (32,7)
fromCoord 264  = (0,8)
fromCoord 265  = (1,8)
fromCoord 266  = (2,8)
fromCoord 267  = (3,8)
fromCoord 268  = (4,8)
fromCoord 269  = (5,8)
fromCoord 270  = (6,8)
fromCoord 271  = (7,8)
fromCoord 272  = (8,8)
fromCoord 273  = (9,8)
fromCoord 274  = (10,8)
fromCoord 275  = (11,8)
fromCoord 276  = (12,8)
fromCoord 277  = (13,8)
fromCoord 278  = (14,8)
fromCoord 279  = (15,8)
fromCoord 280  = (16,8)
fromCoord 281  = (17,8)
fromCoord 282  = (18,8)
fromCoord 283  = (19,8)
fromCoord 284  = (20,8)
fromCoord 285  = (21,8)
fromCoord 286  = (22,8)
fromCoord 287  = (23,8)
fromCoord 288  = (24,8)
fromCoord 289  = (25,8)
fromCoord 290  = (26,8)
fromCoord 291  = (27,8)
fromCoord 292  = (28,8)
fromCoord 293  = (29,8)
fromCoord 294  = (30,8)
fromCoord 295  = (31,8)
fromCoord 296  = (32,8)
fromCoord 297  = (0,9)
fromCoord 298  = (1,9)
fromCoord 299  = (2,9)
fromCoord 300  = (3,9)
fromCoord 301  = (4,9)
fromCoord 302  = (5,9)
fromCoord 303  = (6,9)
fromCoord 304  = (7,9)
fromCoord 305  = (8,9)
fromCoord 306  = (9,9)
fromCoord 307  = (10,9)
fromCoord 308  = (11,9)
fromCoord 309  = (12,9)
fromCoord 310  = (13,9)
fromCoord 311  = (14,9)
fromCoord 312  = (15,9)
fromCoord 313  = (16,9)
fromCoord 314  = (17,9)
fromCoord 315  = (18,9)
fromCoord 316  = (19,9)
fromCoord 317  = (20,9)
fromCoord 318  = (21,9)
fromCoord 319  = (22,9)
fromCoord 320  = (23,9)
fromCoord 321  = (24,9)
fromCoord 322  = (25,9)
fromCoord 323  = (26,9)
fromCoord 324  = (27,9)
fromCoord 325  = (28,9)
fromCoord 326  = (29,9)
fromCoord 327  = (30,9)
fromCoord 328  = (31,9)
fromCoord 329  = (32,9)
fromCoord 330  = (0,10)
fromCoord 331  = (1,10)
fromCoord 332  = (2,10)
fromCoord 333  = (3,10)
fromCoord 334  = (4,10)
fromCoord 335  = (5,10)
fromCoord 336  = (6,10)
fromCoord 337  = (7,10)
fromCoord 338  = (8,10)
fromCoord 339  = (9,10)
fromCoord 340  = (10,10)
fromCoord 341  = (11,10)
fromCoord 342  = (12,10)
fromCoord 343  = (13,10)
fromCoord 344  = (14,10)
fromCoord 345  = (15,10)
fromCoord 346  = (16,10)
fromCoord 347  = (17,10)
fromCoord 348  = (18,10)
fromCoord 349  = (19,10)
fromCoord 350  = (20,10)
fromCoord 351  = (21,10)
fromCoord 352  = (22,10)
fromCoord 353  = (23,10)
fromCoord 354  = (24,10)
fromCoord 355  = (25,10)
fromCoord 356  = (26,10)
fromCoord 357  = (27,10)
fromCoord 358  = (28,10)
fromCoord 359  = (29,10)
fromCoord 360  = (30,10)
fromCoord 361  = (31,10)
fromCoord 362  = (32,10)
fromCoord 363  = (0,11)
fromCoord 364  = (1,11)
fromCoord 365  = (2,11)
fromCoord 366  = (3,11)
fromCoord 367  = (4,11)
fromCoord 368  = (5,11)
fromCoord 369  = (6,11)
fromCoord 370  = (7,11)
fromCoord 371  = (8,11)
fromCoord 372  = (9,11)
fromCoord 373  = (10,11)
fromCoord 374  = (11,11)
fromCoord 375  = (12,11)
fromCoord 376  = (13,11)
fromCoord 377  = (14,11)
fromCoord 378  = (15,11)
fromCoord 379  = (16,11)
fromCoord 380  = (17,11)
fromCoord 381  = (18,11)
fromCoord 382  = (19,11)
fromCoord 383  = (20,11)
fromCoord 384  = (21,11)
fromCoord 385  = (22,11)
fromCoord 386  = (23,11)
fromCoord 387  = (24,11)
fromCoord 388  = (25,11)
fromCoord 389  = (26,11)
fromCoord 390  = (27,11)
fromCoord 391  = (28,11)
fromCoord 392  = (29,11)
fromCoord 393  = (30,11)
fromCoord 394  = (31,11)
fromCoord 395  = (32,11)
fromCoord 396  = (0,12)
fromCoord 397  = (1,12)
fromCoord 398  = (2,12)
fromCoord 399  = (3,12)
fromCoord 400  = (4,12)
fromCoord 401  = (5,12)
fromCoord 402  = (6,12)
fromCoord 403  = (7,12)
fromCoord 404  = (8,12)
fromCoord 405  = (9,12)
fromCoord 406  = (10,12)
fromCoord 407  = (11,12)
fromCoord 408  = (12,12)
fromCoord 409  = (13,12)
fromCoord 410  = (14,12)
fromCoord 411  = (15,12)
fromCoord 412  = (16,12)
fromCoord 413  = (17,12)
fromCoord 414  = (18,12)
fromCoord 415  = (19,12)
fromCoord 416  = (20,12)
fromCoord 417  = (21,12)
fromCoord 418  = (22,12)
fromCoord 419  = (23,12)
fromCoord 420  = (24,12)
fromCoord 421  = (25,12)
fromCoord 422  = (26,12)
fromCoord 423  = (27,12)
fromCoord 424  = (28,12)
fromCoord 425  = (29,12)
fromCoord 426  = (30,12)
fromCoord 427  = (31,12)
fromCoord 428  = (32,12)
fromCoord 429  = (0,13)
fromCoord 430  = (1,13)
fromCoord 431  = (2,13)
fromCoord 432  = (3,13)
fromCoord 433  = (4,13)
fromCoord 434  = (5,13)
fromCoord 435  = (6,13)
fromCoord 436  = (7,13)
fromCoord 437  = (8,13)
fromCoord 438  = (9,13)
fromCoord 439  = (10,13)
fromCoord 440  = (11,13)
fromCoord 441  = (12,13)
fromCoord 442  = (13,13)
fromCoord 443  = (14,13)
fromCoord 444  = (15,13)
fromCoord 445  = (16,13)
fromCoord 446  = (17,13)
fromCoord 447  = (18,13)
fromCoord 448  = (19,13)
fromCoord 449  = (20,13)
fromCoord 450  = (21,13)
fromCoord 451  = (22,13)
fromCoord 452  = (23,13)
fromCoord 453  = (24,13)
fromCoord 454  = (25,13)
fromCoord 455  = (26,13)
fromCoord 456  = (27,13)
fromCoord 457  = (28,13)
fromCoord 458  = (29,13)
fromCoord 459  = (30,13)
fromCoord 460  = (31,13)
fromCoord 461  = (32,13)
fromCoord 462  = (0,14)
fromCoord 463  = (1,14)
fromCoord 464  = (2,14)
fromCoord 465  = (3,14)
fromCoord 466  = (4,14)
fromCoord 467  = (5,14)
fromCoord 468  = (6,14)
fromCoord 469  = (7,14)
fromCoord 470  = (8,14)
fromCoord 471  = (9,14)
fromCoord 472  = (10,14)
fromCoord 473  = (11,14)
fromCoord 474  = (12,14)
fromCoord 475  = (13,14)
fromCoord 476  = (14,14)
fromCoord 477  = (15,14)
fromCoord 478  = (16,14)
fromCoord 479  = (17,14)
fromCoord 480  = (18,14)
fromCoord 481  = (19,14)
fromCoord 482  = (20,14)
fromCoord 483  = (21,14)
fromCoord 484  = (22,14)
fromCoord 485  = (23,14)
fromCoord 486  = (24,14)
fromCoord 487  = (25,14)
fromCoord 488  = (26,14)
fromCoord 489  = (27,14)
fromCoord 490  = (28,14)
fromCoord 491  = (29,14)
fromCoord 492  = (30,14)
fromCoord 493  = (31,14)
fromCoord 494  = (32,14)
fromCoord 495  = (0,15)
fromCoord 496  = (1,15)
fromCoord 497  = (2,15)
fromCoord 498  = (3,15)
fromCoord 499  = (4,15)
fromCoord 500  = (5,15)
fromCoord 501  = (6,15)
fromCoord 502  = (7,15)
fromCoord 503  = (8,15)
fromCoord 504  = (9,15)
fromCoord 505  = (10,15)
fromCoord 506  = (11,15)
fromCoord 507  = (12,15)
fromCoord 508  = (13,15)
fromCoord 509  = (14,15)
fromCoord 510  = (15,15)
fromCoord 511  = (16,15)
fromCoord 512  = (17,15)
fromCoord 513  = (18,15)
fromCoord 514  = (19,15)
fromCoord 515  = (20,15)
fromCoord 516  = (21,15)
fromCoord 517  = (22,15)
fromCoord 518  = (23,15)
fromCoord 519  = (24,15)
fromCoord 520  = (25,15)
fromCoord 521  = (26,15)
fromCoord 522  = (27,15)
fromCoord 523  = (28,15)
fromCoord 524  = (29,15)
fromCoord 525  = (30,15)
fromCoord 526  = (31,15)
fromCoord 527  = (32,15)
fromCoord 528  = (0,16)
fromCoord 529  = (1,16)
fromCoord 530  = (2,16)
fromCoord 531  = (3,16)
fromCoord 532  = (4,16)
fromCoord 533  = (5,16)
fromCoord 534  = (6,16)
fromCoord 535  = (7,16)
fromCoord 536  = (8,16)
fromCoord 537  = (9,16)
fromCoord 538  = (10,16)
fromCoord 539  = (11,16)
fromCoord 540  = (12,16)
fromCoord 541  = (13,16)
fromCoord 542  = (14,16)
fromCoord 543  = (15,16)
fromCoord 544  = (16,16)
fromCoord 545  = (17,16)
fromCoord 546  = (18,16)
fromCoord 547  = (19,16)
fromCoord 548  = (20,16)
fromCoord 549  = (21,16)
fromCoord 550  = (22,16)
fromCoord 551  = (23,16)
fromCoord 552  = (24,16)
fromCoord 553  = (25,16)
fromCoord 554  = (26,16)
fromCoord 555  = (27,16)
fromCoord 556  = (28,16)
fromCoord 557  = (29,16)
fromCoord 558  = (30,16)
fromCoord 559  = (31,16)
fromCoord 560  = (32,16)
fromCoord 561  = (0,17)
fromCoord 562  = (1,17)
fromCoord 563  = (2,17)
fromCoord 564  = (3,17)
fromCoord 565  = (4,17)
fromCoord 566  = (5,17)
fromCoord 567  = (6,17)
fromCoord 568  = (7,17)
fromCoord 569  = (8,17)
fromCoord 570  = (9,17)
fromCoord 571  = (10,17)
fromCoord 572  = (11,17)
fromCoord 573  = (12,17)
fromCoord 574  = (13,17)
fromCoord 575  = (14,17)
fromCoord 576  = (15,17)
fromCoord 577  = (16,17)
fromCoord 578  = (17,17)
fromCoord 579  = (18,17)
fromCoord 580  = (19,17)
fromCoord 581  = (20,17)
fromCoord 582  = (21,17)
fromCoord 583  = (22,17)
fromCoord 584  = (23,17)
fromCoord 585  = (24,17)
fromCoord 586  = (25,17)
fromCoord 587  = (26,17)
fromCoord 588  = (27,17)
fromCoord 589  = (28,17)
fromCoord 590  = (29,17)
fromCoord 591  = (30,17)
fromCoord 592  = (31,17)
fromCoord 593  = (32,17)
fromCoord 594  = (0,18)
fromCoord 595  = (1,18)
fromCoord 596  = (2,18)
fromCoord 597  = (3,18)
fromCoord 598  = (4,18)
fromCoord 599  = (5,18)
fromCoord 600  = (6,18)
fromCoord 601  = (7,18)
fromCoord 602  = (8,18)
fromCoord 603  = (9,18)
fromCoord 604  = (10,18)
fromCoord 605  = (11,18)
fromCoord 606  = (12,18)
fromCoord 607  = (13,18)
fromCoord 608  = (14,18)
fromCoord 609  = (15,18)
fromCoord 610  = (16,18)
fromCoord 611  = (17,18)
fromCoord 612  = (18,18)
fromCoord 613  = (19,18)
fromCoord 614  = (20,18)
fromCoord 615  = (21,18)
fromCoord 616  = (22,18)
fromCoord 617  = (23,18)
fromCoord 618  = (24,18)
fromCoord 619  = (25,18)
fromCoord 620  = (26,18)
fromCoord 621  = (27,18)
fromCoord 622  = (28,18)
fromCoord 623  = (29,18)
fromCoord 624  = (30,18)
fromCoord 625  = (31,18)
fromCoord 626  = (32,18)
fromCoord 627  = (0,19)
fromCoord 628  = (1,19)
fromCoord 629  = (2,19)
fromCoord 630  = (3,19)
fromCoord 631  = (4,19)
fromCoord 632  = (5,19)
fromCoord 633  = (6,19)
fromCoord 634  = (7,19)
fromCoord 635  = (8,19)
fromCoord 636  = (9,19)
fromCoord 637  = (10,19)
fromCoord 638  = (11,19)
fromCoord 639  = (12,19)
fromCoord 640  = (13,19)
fromCoord 641  = (14,19)
fromCoord 642  = (15,19)
fromCoord 643  = (16,19)
fromCoord 644  = (17,19)
fromCoord 645  = (18,19)
fromCoord 646  = (19,19)
fromCoord 647  = (20,19)
fromCoord 648  = (21,19)
fromCoord 649  = (22,19)
fromCoord 650  = (23,19)
fromCoord 651  = (24,19)
fromCoord 652  = (25,19)
fromCoord 653  = (26,19)
fromCoord 654  = (27,19)
fromCoord 655  = (28,19)
fromCoord 656  = (29,19)
fromCoord 657  = (30,19)
fromCoord 658  = (31,19)
fromCoord 659  = (32,19)
fromCoord 660  = (0,20)
fromCoord 661  = (1,20)
fromCoord 662  = (2,20)
fromCoord 663  = (3,20)
fromCoord 664  = (4,20)
fromCoord 665  = (5,20)
fromCoord 666  = (6,20)
fromCoord 667  = (7,20)
fromCoord 668  = (8,20)
fromCoord 669  = (9,20)
fromCoord 670  = (10,20)
fromCoord 671  = (11,20)
fromCoord 672  = (12,20)
fromCoord 673  = (13,20)
fromCoord 674  = (14,20)
fromCoord 675  = (15,20)
fromCoord 676  = (16,20)
fromCoord 677  = (17,20)
fromCoord 678  = (18,20)
fromCoord 679  = (19,20)
fromCoord 680  = (20,20)
fromCoord 681  = (21,20)
fromCoord 682  = (22,20)
fromCoord 683  = (23,20)
fromCoord 684  = (24,20)
fromCoord 685  = (25,20)
fromCoord 686  = (26,20)
fromCoord 687  = (27,20)
fromCoord 688  = (28,20)
fromCoord 689  = (29,20)
fromCoord 690  = (30,20)
fromCoord 691  = (31,20)
fromCoord 692  = (32,20)
fromCoord 693  = (0,21)
fromCoord 694  = (1,21)
fromCoord 695  = (2,21)
fromCoord 696  = (3,21)
fromCoord 697  = (4,21)
fromCoord 698  = (5,21)
fromCoord 699  = (6,21)
fromCoord 700  = (7,21)
fromCoord 701  = (8,21)
fromCoord 702  = (9,21)
fromCoord 703  = (10,21)
fromCoord 704  = (11,21)
fromCoord 705  = (12,21)
fromCoord 706  = (13,21)
fromCoord 707  = (14,21)
fromCoord 708  = (15,21)
fromCoord 709  = (16,21)
fromCoord 710  = (17,21)
fromCoord 711  = (18,21)
fromCoord 712  = (19,21)
fromCoord 713  = (20,21)
fromCoord 714  = (21,21)
fromCoord 715  = (22,21)
fromCoord 716  = (23,21)
fromCoord 717  = (24,21)
fromCoord 718  = (25,21)
fromCoord 719  = (26,21)
fromCoord 720  = (27,21)
fromCoord 721  = (28,21)
fromCoord 722  = (29,21)
fromCoord 723  = (30,21)
fromCoord 724  = (31,21)
fromCoord 725  = (32,21)
fromCoord 726  = (0,22)
fromCoord 727  = (1,22)
fromCoord 728  = (2,22)
fromCoord 729  = (3,22)
fromCoord 730  = (4,22)
fromCoord 731  = (5,22)
fromCoord 732  = (6,22)
fromCoord 733  = (7,22)
fromCoord 734  = (8,22)
fromCoord 735  = (9,22)
fromCoord 736  = (10,22)
fromCoord 737  = (11,22)
fromCoord 738  = (12,22)
fromCoord 739  = (13,22)
fromCoord 740  = (14,22)
fromCoord 741  = (15,22)
fromCoord 742  = (16,22)
fromCoord 743  = (17,22)
fromCoord 744  = (18,22)
fromCoord 745  = (19,22)
fromCoord 746  = (20,22)
fromCoord 747  = (21,22)
fromCoord 748  = (22,22)
fromCoord 749  = (23,22)
fromCoord 750  = (24,22)
fromCoord 751  = (25,22)
fromCoord 752  = (26,22)
fromCoord 753  = (27,22)
fromCoord 754  = (28,22)
fromCoord 755  = (29,22)
fromCoord 756  = (30,22)
fromCoord 757  = (31,22)
fromCoord 758  = (32,22)
fromCoord 759  = (0,23)
fromCoord 760  = (1,23)
fromCoord 761  = (2,23)
fromCoord 762  = (3,23)
fromCoord 763  = (4,23)
fromCoord 764  = (5,23)
fromCoord 765  = (6,23)
fromCoord 766  = (7,23)
fromCoord 767  = (8,23)
fromCoord 768  = (9,23)
fromCoord 769  = (10,23)
fromCoord 770  = (11,23)
fromCoord 771  = (12,23)
fromCoord 772  = (13,23)
fromCoord 773  = (14,23)
fromCoord 774  = (15,23)
fromCoord 775  = (16,23)
fromCoord 776  = (17,23)
fromCoord 777  = (18,23)
fromCoord 778  = (19,23)
fromCoord 779  = (20,23)
fromCoord 780  = (21,23)
fromCoord 781  = (22,23)
fromCoord 782  = (23,23)
fromCoord 783  = (24,23)
fromCoord 784  = (25,23)
fromCoord 785  = (26,23)
fromCoord 786  = (27,23)
fromCoord 787  = (28,23)
fromCoord 788  = (29,23)
fromCoord 789  = (30,23)
fromCoord 790  = (31,23)
fromCoord 791  = (32,23)
fromCoord 792  = (0,24)
fromCoord 793  = (1,24)
fromCoord 794  = (2,24)
fromCoord 795  = (3,24)
fromCoord 796  = (4,24)
fromCoord 797  = (5,24)
fromCoord 798  = (6,24)
fromCoord 799  = (7,24)
fromCoord 800  = (8,24)
fromCoord 801  = (9,24)
fromCoord 802  = (10,24)
fromCoord 803  = (11,24)
fromCoord 804  = (12,24)
fromCoord 805  = (13,24)
fromCoord 806  = (14,24)
fromCoord 807  = (15,24)
fromCoord 808  = (16,24)
fromCoord 809  = (17,24)
fromCoord 810  = (18,24)
fromCoord 811  = (19,24)
fromCoord 812  = (20,24)
fromCoord 813  = (21,24)
fromCoord 814  = (22,24)
fromCoord 815  = (23,24)
fromCoord 816  = (24,24)
fromCoord 817  = (25,24)
fromCoord 818  = (26,24)
fromCoord 819  = (27,24)
fromCoord 820  = (28,24)
fromCoord 821  = (29,24)
fromCoord 822  = (30,24)
fromCoord 823  = (31,24)
fromCoord 824  = (32,24)
fromCoord 825  = (0,25)
fromCoord 826  = (1,25)
fromCoord 827  = (2,25)
fromCoord 828  = (3,25)
fromCoord 829  = (4,25)
fromCoord 830  = (5,25)
fromCoord 831  = (6,25)
fromCoord 832  = (7,25)
fromCoord 833  = (8,25)
fromCoord 834  = (9,25)
fromCoord 835  = (10,25)
fromCoord 836  = (11,25)
fromCoord 837  = (12,25)
fromCoord 838  = (13,25)
fromCoord 839  = (14,25)
fromCoord 840  = (15,25)
fromCoord 841  = (16,25)
fromCoord 842  = (17,25)
fromCoord 843  = (18,25)
fromCoord 844  = (19,25)
fromCoord 845  = (20,25)
fromCoord 846  = (21,25)
fromCoord 847  = (22,25)
fromCoord 848  = (23,25)
fromCoord 849  = (24,25)
fromCoord 850  = (25,25)
fromCoord 851  = (26,25)
fromCoord 852  = (27,25)
fromCoord 853  = (28,25)
fromCoord 854  = (29,25)
fromCoord 855  = (30,25)
fromCoord 856  = (31,25)
fromCoord 857  = (32,25)
fromCoord 858  = (0,26)
fromCoord 859  = (1,26)
fromCoord 860  = (2,26)
fromCoord 861  = (3,26)
fromCoord 862  = (4,26)
fromCoord 863  = (5,26)
fromCoord 864  = (6,26)
fromCoord 865  = (7,26)
fromCoord 866  = (8,26)
fromCoord 867  = (9,26)
fromCoord 868  = (10,26)
fromCoord 869  = (11,26)
fromCoord 870  = (12,26)
fromCoord 871  = (13,26)
fromCoord 872  = (14,26)
fromCoord 873  = (15,26)
fromCoord 874  = (16,26)
fromCoord 875  = (17,26)
fromCoord 876  = (18,26)
fromCoord 877  = (19,26)
fromCoord 878  = (20,26)
fromCoord 879  = (21,26)
fromCoord 880  = (22,26)
fromCoord 881  = (23,26)
fromCoord 882  = (24,26)
fromCoord 883  = (25,26)
fromCoord 884  = (26,26)
fromCoord 885  = (27,26)
fromCoord 886  = (28,26)
fromCoord 887  = (29,26)
fromCoord 888  = (30,26)
fromCoord 889  = (31,26)
fromCoord 890  = (32,26)
fromCoord 891  = (0,27)
fromCoord 892  = (1,27)
fromCoord 893  = (2,27)
fromCoord 894  = (3,27)
fromCoord 895  = (4,27)
fromCoord 896  = (5,27)
fromCoord 897  = (6,27)
fromCoord 898  = (7,27)
fromCoord 899  = (8,27)
fromCoord 900  = (9,27)
fromCoord 901  = (10,27)
fromCoord 902  = (11,27)
fromCoord 903  = (12,27)
fromCoord 904  = (13,27)
fromCoord 905  = (14,27)
fromCoord 906  = (15,27)
fromCoord 907  = (16,27)
fromCoord 908  = (17,27)
fromCoord 909  = (18,27)
fromCoord 910  = (19,27)
fromCoord 911  = (20,27)
fromCoord 912  = (21,27)
fromCoord 913  = (22,27)
fromCoord 914  = (23,27)
fromCoord 915  = (24,27)
fromCoord 916  = (25,27)
fromCoord 917  = (26,27)
fromCoord 918  = (27,27)
fromCoord 919  = (28,27)
fromCoord 920  = (29,27)
fromCoord 921  = (30,27)
fromCoord 922  = (31,27)
fromCoord 923  = (32,27)
fromCoord 924  = (0,28)
fromCoord 925  = (1,28)
fromCoord 926  = (2,28)
fromCoord 927  = (3,28)
fromCoord 928  = (4,28)
fromCoord 929  = (5,28)
fromCoord 930  = (6,28)
fromCoord 931  = (7,28)
fromCoord 932  = (8,28)
fromCoord 933  = (9,28)
fromCoord 934  = (10,28)
fromCoord 935  = (11,28)
fromCoord 936  = (12,28)
fromCoord 937  = (13,28)
fromCoord 938  = (14,28)
fromCoord 939  = (15,28)
fromCoord 940  = (16,28)
fromCoord 941  = (17,28)
fromCoord 942  = (18,28)
fromCoord 943  = (19,28)
fromCoord 944  = (20,28)
fromCoord 945  = (21,28)
fromCoord 946  = (22,28)
fromCoord 947  = (23,28)
fromCoord 948  = (24,28)
fromCoord 949  = (25,28)
fromCoord 950  = (26,28)
fromCoord 951  = (27,28)
fromCoord 952  = (28,28)
fromCoord 953  = (29,28)
fromCoord 954  = (30,28)
fromCoord 955  = (31,28)
fromCoord 956  = (32,28)
fromCoord 957  = (0,29)
fromCoord 958  = (1,29)
fromCoord 959  = (2,29)
fromCoord 960  = (3,29)
fromCoord 961  = (4,29)
fromCoord 962  = (5,29)
fromCoord 963  = (6,29)
fromCoord 964  = (7,29)
fromCoord 965  = (8,29)
fromCoord 966  = (9,29)
fromCoord 967  = (10,29)
fromCoord 968  = (11,29)
fromCoord 969  = (12,29)
fromCoord 970  = (13,29)
fromCoord 971  = (14,29)
fromCoord 972  = (15,29)
fromCoord 973  = (16,29)
fromCoord 974  = (17,29)
fromCoord 975  = (18,29)
fromCoord 976  = (19,29)
fromCoord 977  = (20,29)
fromCoord 978  = (21,29)
fromCoord 979  = (22,29)
fromCoord 980  = (23,29)
fromCoord 981  = (24,29)
fromCoord 982  = (25,29)
fromCoord 983  = (26,29)
fromCoord 984  = (27,29)
fromCoord 985  = (28,29)
fromCoord 986  = (29,29)
fromCoord 987  = (30,29)
fromCoord 988  = (31,29)
fromCoord 989  = (32,29)
fromCoord 990  = (0,30)
fromCoord 991  = (1,30)
fromCoord 992  = (2,30)
fromCoord 993  = (3,30)
fromCoord 994  = (4,30)
fromCoord 995  = (5,30)
fromCoord 996  = (6,30)
fromCoord 997  = (7,30)
fromCoord 998  = (8,30)
fromCoord 999  = (9,30)
fromCoord 1000 = (10,30)
fromCoord 1001 = (11,30)
fromCoord 1002 = (12,30)
fromCoord 1003 = (13,30)
fromCoord 1004 = (14,30)
fromCoord 1005 = (15,30)
fromCoord 1006 = (16,30)
fromCoord 1007 = (17,30)
fromCoord 1008 = (18,30)
fromCoord 1009 = (19,30)
fromCoord 1010 = (20,30)
fromCoord 1011 = (21,30)
fromCoord 1012 = (22,30)
fromCoord 1013 = (23,30)
fromCoord 1014 = (24,30)
fromCoord 1015 = (25,30)
fromCoord 1016 = (26,30)
fromCoord 1017 = (27,30)
fromCoord 1018 = (28,30)
fromCoord 1019 = (29,30)
fromCoord 1020 = (30,30)
fromCoord 1021 = (31,30)
fromCoord 1022 = (32,30)
fromCoord 1023 = (0,31)
fromCoord 1024 = (1,31)
fromCoord 1025 = (2,31)
fromCoord 1026 = (3,31)
fromCoord 1027 = (4,31)
fromCoord 1028 = (5,31)
fromCoord 1029 = (6,31)
fromCoord 1030 = (7,31)
fromCoord 1031 = (8,31)
fromCoord 1032 = (9,31)
fromCoord 1033 = (10,31)
fromCoord 1034 = (11,31)
fromCoord 1035 = (12,31)
fromCoord 1036 = (13,31)
fromCoord 1037 = (14,31)
fromCoord 1038 = (15,31)
fromCoord 1039 = (16,31)
fromCoord 1040 = (17,31)
fromCoord 1041 = (18,31)
fromCoord 1042 = (19,31)
fromCoord 1043 = (20,31)
fromCoord 1044 = (21,31)
fromCoord 1045 = (22,31)
fromCoord 1046 = (23,31)
fromCoord 1047 = (24,31)
fromCoord 1048 = (25,31)
fromCoord 1049 = (26,31)
fromCoord 1050 = (27,31)
fromCoord 1051 = (28,31)
fromCoord 1052 = (29,31)
fromCoord 1053 = (30,31)
fromCoord 1054 = (31,31)
fromCoord 1055 = (32,31)
fromCoord 1056 = (0,32)
fromCoord 1057 = (1,32)
fromCoord 1058 = (2,32)
fromCoord 1059 = (3,32)
fromCoord 1060 = (4,32)
fromCoord 1061 = (5,32)
fromCoord 1062 = (6,32)
fromCoord 1063 = (7,32)
fromCoord 1064 = (8,32)
fromCoord 1065 = (9,32)
fromCoord 1066 = (10,32)
fromCoord 1067 = (11,32)
fromCoord 1068 = (12,32)
fromCoord 1069 = (13,32)
fromCoord 1070 = (14,32)
fromCoord 1071 = (15,32)
fromCoord 1072 = (16,32)
fromCoord 1073 = (17,32)
fromCoord 1074 = (18,32)
fromCoord 1075 = (19,32)
fromCoord 1076 = (20,32)
fromCoord 1077 = (21,32)
fromCoord 1078 = (22,32)
fromCoord 1079 = (23,32)
fromCoord 1080 = (24,32)
fromCoord 1081 = (25,32)
fromCoord 1082 = (26,32)
fromCoord 1083 = (27,32)
fromCoord 1084 = (28,32)
fromCoord 1085 = (29,32)
fromCoord 1086 = (30,32)
fromCoord 1087 = (31,32)
fromCoord 1088 = (32,32)
fromCoord x    = error $ "fromCoord: " ++ show x

isOnNorthernBorder :: Coord -> Bool
isOnNorthernBorder 0  = True
isOnNorthernBorder 1  = True
isOnNorthernBorder 2  = True
isOnNorthernBorder 3  = True
isOnNorthernBorder 4  = True
isOnNorthernBorder 5  = True
isOnNorthernBorder 6  = True
isOnNorthernBorder 7  = True
isOnNorthernBorder 8  = True
isOnNorthernBorder 9  = True
isOnNorthernBorder 10 = True
isOnNorthernBorder 11 = True
isOnNorthernBorder 12 = True
isOnNorthernBorder 13 = True
isOnNorthernBorder 14 = True
isOnNorthernBorder 15 = True
isOnNorthernBorder 16 = True
isOnNorthernBorder 17 = True
isOnNorthernBorder 18 = True
isOnNorthernBorder 19 = True
isOnNorthernBorder 20 = True
isOnNorthernBorder 21 = True
isOnNorthernBorder 22 = True
isOnNorthernBorder 23 = True
isOnNorthernBorder 24 = True
isOnNorthernBorder 25 = True
isOnNorthernBorder 26 = True
isOnNorthernBorder 27 = True
isOnNorthernBorder 28 = True
isOnNorthernBorder 29 = True
isOnNorthernBorder 30 = True
isOnNorthernBorder 31 = True
isOnNorthernBorder 32 = True
isOnNorthernBorder _  = False

isOnEasternBorder :: Coord -> Bool
isOnEasternBorder 32   = True
isOnEasternBorder 65   = True
isOnEasternBorder 98   = True
isOnEasternBorder 131  = True
isOnEasternBorder 164  = True
isOnEasternBorder 197  = True
isOnEasternBorder 230  = True
isOnEasternBorder 263  = True
isOnEasternBorder 296  = True
isOnEasternBorder 329  = True
isOnEasternBorder 362  = True
isOnEasternBorder 395  = True
isOnEasternBorder 428  = True
isOnEasternBorder 461  = True
isOnEasternBorder 494  = True
isOnEasternBorder 527  = True
isOnEasternBorder 560  = True
isOnEasternBorder 593  = True
isOnEasternBorder 626  = True
isOnEasternBorder 659  = True
isOnEasternBorder 692  = True
isOnEasternBorder 725  = True
isOnEasternBorder 758  = True
isOnEasternBorder 791  = True
isOnEasternBorder 824  = True
isOnEasternBorder 857  = True
isOnEasternBorder 890  = True
isOnEasternBorder 923  = True
isOnEasternBorder 956  = True
isOnEasternBorder 989  = True
isOnEasternBorder 1022 = True
isOnEasternBorder 1055 = True
isOnEasternBorder 1088 = True
isOnEasternBorder _    = False

isOnSouthernBorder :: Coord -> Bool
isOnSouthernBorder 1056 = True
isOnSouthernBorder 1057 = True
isOnSouthernBorder 1058 = True
isOnSouthernBorder 1059 = True
isOnSouthernBorder 1060 = True
isOnSouthernBorder 1061 = True
isOnSouthernBorder 1062 = True
isOnSouthernBorder 1063 = True
isOnSouthernBorder 1064 = True
isOnSouthernBorder 1065 = True
isOnSouthernBorder 1066 = True
isOnSouthernBorder 1067 = True
isOnSouthernBorder 1068 = True
isOnSouthernBorder 1069 = True
isOnSouthernBorder 1070 = True
isOnSouthernBorder 1071 = True
isOnSouthernBorder 1072 = True
isOnSouthernBorder 1073 = True
isOnSouthernBorder 1074 = True
isOnSouthernBorder 1075 = True
isOnSouthernBorder 1076 = True
isOnSouthernBorder 1077 = True
isOnSouthernBorder 1078 = True
isOnSouthernBorder 1079 = True
isOnSouthernBorder 1080 = True
isOnSouthernBorder 1081 = True
isOnSouthernBorder 1082 = True
isOnSouthernBorder 1083 = True
isOnSouthernBorder 1084 = True
isOnSouthernBorder 1085 = True
isOnSouthernBorder 1086 = True
isOnSouthernBorder 1087 = True
isOnSouthernBorder 1088 = True
isOnSouthernBorder _    = False

isOnWesternBorder :: Coord -> Bool
isOnWesternBorder 0    = True
isOnWesternBorder 33   = True
isOnWesternBorder 66   = True
isOnWesternBorder 99   = True
isOnWesternBorder 132  = True
isOnWesternBorder 165  = True
isOnWesternBorder 198  = True
isOnWesternBorder 231  = True
isOnWesternBorder 264  = True
isOnWesternBorder 297  = True
isOnWesternBorder 330  = True
isOnWesternBorder 363  = True
isOnWesternBorder 396  = True
isOnWesternBorder 429  = True
isOnWesternBorder 462  = True
isOnWesternBorder 495  = True
isOnWesternBorder 528  = True
isOnWesternBorder 561  = True
isOnWesternBorder 594  = True
isOnWesternBorder 627  = True
isOnWesternBorder 660  = True
isOnWesternBorder 693  = True
isOnWesternBorder 726  = True
isOnWesternBorder 759  = True
isOnWesternBorder 792  = True
isOnWesternBorder 825  = True
isOnWesternBorder 858  = True
isOnWesternBorder 891  = True
isOnWesternBorder 924  = True
isOnWesternBorder 957  = True
isOnWesternBorder 990  = True
isOnWesternBorder 1023 = True
isOnWesternBorder 1056 = True
isOnWesternBorder _    = False

integerDistanceResolution :: Int
integerDistanceResolution = 1000000

allIntegerDistances :: V.Vector Int
allIntegerDistances =
  V.fromList $ do
    this <- [0..mapLength - 1]
    that <- [0..mapLength - 1]
    return $ integerDistance' this that
  where
    integerDistance' :: Coord -> Coord -> Int
    integerDistance' xy' xy'' =
      let (x',  y')  = fromCoord xy'
          (x'', y'') = fromCoord xy''
          dx         = fromIntegral $ x' - x''
          dy         = fromIntegral $ y' - y''
      in round $ (fromIntegral integerDistanceResolution) * sqrt (((dx::Double) ** 2) + (dy ** 2))

integerDistance :: Coord -> Coord -> Int
integerDistance xy' xy'' =
  allManhattanDistances `UV.unsafeIndex` (xy' * mapLength + xy'')

maxSumOfDistancePairs :: Int
maxSumOfDistancePairs = (mapDim * integerDistanceResolution) * 3

aligns :: Coord -> Coord -> Bool
aligns xy' xy'' =
  let (x', y')   = fromCoord xy'
      (x'', y'') = fromCoord xy''
  in x' == x'' ||
     y' == y'' ||
     (abs (x' - x'')) == (abs (y' -y''))

midCoord :: Coord
midCoord = toCoord 16 16

manhattanDistanceToMiddle :: Coord -> Int
manhattanDistanceToMiddle coord' =
  manhattanDistance coord' midCoord

isCloserByManhattanDistance :: Coord -> Coord -> Bool
isCloserByManhattanDistance this that =
  manhattanDistanceToMiddle this < manhattanDistanceToMiddle that
